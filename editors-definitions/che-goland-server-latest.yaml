#
# Copyright (c) 2025 Red Hat, Inc.
# This program and the accompanying materials are made
# available under the terms of the Eclipse Public License 2.0
# which is available at https://www.eclipse.org/legal/epl-2.0/
#
# SPDX-License-Identifier: EPL-2.0
#
# Contributors:
#   Red Hat, Inc. - initial API and implementation
#

schemaVersion: 2.2.2
metadata:
  name: che-goland-server
  displayName: JetBrains GoLand (desktop)
  description: JetBrains GoLand dev server for Eclipse Che - latest
  tags:
    - Tech-Preview
  attributes:
    arch:
      - x86_64
      - arm64
    publisher: che-incubator
    version: latest
    provider: Provided by [Jet Brains](https://www.jetbrains.com/) under [License](https://www.jetbrains.com/legal/docs/toolbox/user/)
    title: JetBrains GoLand for Eclipse Che - latest
    repository: https://github.com/che-incubator/che-idea-dev-server
    firstPublicationDate: '2025-15-08'
    iconMediatype: image/svg+xml
    iconData: |
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="none" viewBox="0 0 64 64">
      <defs>
      <linearGradient id="a" x1="64.3912" x2="39.6074" y1="56.3294" y2="2.87437" gradientUnits="userSpaceOnUse">
      <stop offset=".24" stop-color="#00D886"/>
      <stop offset=".51" stop-color="#007DFE"/>
      </linearGradient>
      <linearGradient id="b" x1="59.6762" x2="1.08" y1="4.06688" y2="62.6631" gradientUnits="userSpaceOnUse">
      <stop offset=".27" stop-color="#007DFE"/>
      <stop offset=".7" stop-color="#D249FC"/>
      </linearGradient>
      </defs>
      <path fill="#00D886" d="M47.55 58h12.2588c2.3037 0 4.1612-1.8869 4.1243-4.1906l-.1762-11.0431c-.0188-1.1813-.5431-2.2975-1.44-3.0663L24.1588 6.99312C23.4113 6.3525 22.4587 6 21.4744 6H10.125C7.84687 6 6 7.84687 6 10.125v11.0031c0 1.1894.51375 2.3213 1.40875 3.1044L44.8338 56.9794C45.5856 57.6375 46.5506 58 47.55 58Z"/>
      <path fill="url(#a)" d="M49.0131 58h10.8618c2.2781 0 4.125-1.8469 4.125-4.125V41.3094c0-.2-.0144-.4-.0437-.5981L58.508 3.52688C58.2118 1.50125 56.4743 0 54.4268 0H39.0293c-2.2788 0-4.1256 1.8475-4.125 4.12625l.0044 18.50435c0 .4256.0662.8488.1956 1.2538L45.083 55.13c.5463 1.7094 2.135 2.87 3.9294 2.87h.0007Z"/>
      <path fill="url(#b)" d="M4.125 64h34.1275c1.6581 0 3.155-.9931 3.8-2.5206L57.85 24.0581c.2187-.5181.3294-1.0756.3244-1.6381l-.15-18.32875C58.0063 1.82625 56.165 0 53.9 0H36.2344c-.8057 0-1.5932.235625-2.2663.678125L1.85938 21.7869C.69875 22.55 0 23.845 0 25.2337V59.875C0 62.1531 1.84687 64 4.125 64Z"/>
      <path fill="#000" d="M52 12H12v40h40V12Z"/>
      <path fill="#fff" d="M19.7484 31.2425c-1.165-.675-2.0793-1.6044-2.7437-2.7869-.6644-1.1825-.9969-2.5025-.9969-3.9606s.3325-2.7781.9969-3.9606 1.5794-2.1119 2.7437-2.7869c1.1644-.675 2.465-1.0131 3.9019-1.0131 1.1644 0 2.2381.2075 3.2213.6219.9825.4143 1.8112.9968 2.4868 1.7468.675.75 1.1488 1.615 1.42 2.5938h-3.13c-.2287-.4719-.5375-.8806-.9268-1.2275-.3894-.3463-.845-.6144-1.3669-.8038s-1.0825-.2837-1.6831-.2837c-.8863 0-1.6863.2212-2.4013.6643-.7144.4432-1.2737 1.0526-1.6775 1.8276-.4037.7756-.6056 1.6487-.6056 2.6206s.2019 1.8456.6056 2.6206c.4038.7756.9631 1.3844 1.6775 1.8275.7144.4431 1.515.6644 2.4013.6644.8218 0 1.5668-.1538 2.235-.4613.6681-.3069 1.1987-.7325 1.5918-1.2756.3932-.5431.6038-1.1538.6325-1.8331l.0107.3106h-3.5263v-2.3044h6.3563v1.1794c0 1.3219-.32 2.5175-.9594 3.5856-.6394 1.0681-1.515 1.91-2.6263 2.5244-1.1112.6144-2.3562.9219-3.7356.9219s-2.7369-.3375-3.9019-1.0131v.0012Z"/>
      <path fill="#fff" d="M36.2712 31.2425c-1.1681-.675-2.0869-1.6044-2.755-2.7869-.6682-1.1825-1.0025-2.5025-1.0025-3.9606s.3337-2.7781 1.0025-3.9606c.6681-1.1825 1.5862-2.1119 2.755-2.7869 1.1681-.675 2.4743-1.0131 3.9175-1.0131 1.4431 0 2.7387.3375 3.9069 1.0131 1.1681.675 2.0849 1.6044 2.7493 2.7869.6644 1.1825.9969 2.5025.9969 3.9606s-.3325 2.7781-.9969 3.9606-1.5812 2.1119-2.7493 2.7869c-1.1682.675-2.4707 1.0131-3.9069 1.0131-1.4363 0-2.7494-.3375-3.9175-1.0131Zm6.3081-2.2294c.7075-.4462 1.2612-1.065 1.6612-1.8543.4-.7894.6-1.6775.6-2.6638 0-.9862-.2-1.8738-.6-2.6638-.4-.7893-.9537-1.4074-1.6612-1.8543-.7075-.4463-1.5044-.67-2.39-.67-.8856 0-1.685.2231-2.3956.67-.7113.4469-1.2688 1.065-1.6719 1.8543-.4038.7894-.6056 1.6776-.6056 2.6638 0 .9863.2018 1.8744.6056 2.6638.4037.7893.9612 1.4081 1.6719 1.8543.7112.4469 1.5094.67 2.3956.67.8863 0 1.6825-.2231 2.39-.67Z"/>
      <path fill="#fff" d="M33 44H17v3h16v-3Z"/>
      </svg>
commands:
  - id: inject-editor
    apply:
      component: editor-injector
  - id: start-ide-server
    exec:
      component: editor-runtime
      commandLine: nohup /idea-server/entrypoint-volume.sh > /idea-server/std.out 2>&1 &
events:
  preStart:
    - inject-editor
  postStart:
    - start-ide-server
components:
  - name: idea-server
    volume: {}
  - name: editor-injector
    container:
      image: quay.io/che-incubator/che-idea-dev-server:latest
      command: ['/entrypoint-init-container.sh', 'goland', 'che-incubator/che-goland-server/latest']
      volumeMounts:
        - name: idea-server
          path: /idea-server
      memoryLimit: 256Mi
      memoryRequest: 32Mi
      cpuLimit: 500m
      cpuRequest: 30m
  - name: editor-runtime
    container:
      image: quay.io/devfile/universal-developer-image:latest
      memoryLimit: 6144Mi
      memoryRequest: 2048Mi
      cpuLimit: 2000m
      cpuRequest: 1500m
      volumeMounts:
        - name: idea-server
          path: /idea-server
      endpoints:
        - name: idea-server
          attributes:
            type: main
            cookiesAuthEnabled: true
            discoverable: false
            urlRewriteSupported: true
          targetPort: 3400
          exposure: public
          secure: true
          protocol: https
    attributes:
      app.kubernetes.io/component: editor-runtime
      app.kubernetes.io/part-of: idea-server.eclipse.org
      controller.devfile.io/container-contribution: true
